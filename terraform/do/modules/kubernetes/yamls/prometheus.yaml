# Prometheus Configuration - Variables Only (minimal, replica count = 1)
# All variables are injected via Terraform templatefile() in prometheus.tf
# Defaults ref: _prometheus.yaml

## =========================
## Operator (image + resources)
## =========================
operator:
  enabled: true
  image:
    registry: docker.io
    repository: bitnamilegacy/prometheus-operator
  resources:
    requests:
      cpu: ${operator_request_cpu}
      memory: ${operator_request_memory}
    limits:
      cpu: ${operator_limit_cpu}
      memory: ${operator_limit_memory}
  nodeSelector:
    "doks.digitalocean.com/node-pool": ${node_pool_label}

## =========================
## Prometheus (replicaCount from TF, image, resources, storage)
## =========================
prometheus:
  replicaCount: ${prometheus_replica_count}
  image:
    registry: docker.io
    repository: bitnamilegacy/prometheus
  prometheusSpec:
    resources:
      requests:
        cpu: ${prometheus_request_cpu}
        memory: ${prometheus_request_memory}
      limits:
        cpu: ${prometheus_limit_cpu}
        memory: ${prometheus_limit_memory}
    nodeSelector:
      "doks.digitalocean.com/node-pool": ${node_pool_label}
    storageSpec:
      volumeClaimTemplate:
        spec:
          resources:
            requests:
              storage: ${prometheus_persistence_size}
    thanos:
      resources:
        requests:
          cpu: ${thanos_request_cpu}
          memory: ${thanos_request_memory}
        limits:
          cpu: ${thanos_limit_cpu}
          memory: ${thanos_limit_memory}

## =========================
## Alertmanager (replicaCount from TF, image, resources, storage)
## =========================
alertmanager:
  replicaCount: ${alertmanager_replica_count}
  image:
    registry: docker.io
    repository: bitnamilegacy/alertmanager
  alertmanagerSpec:
    resources:
      requests:
        cpu: ${alertmanager_request_cpu}
        memory: ${alertmanager_request_memory}
      limits:
        cpu: ${alertmanager_limit_cpu}
        memory: ${alertmanager_limit_memory}
    nodeSelector:
      "doks.digitalocean.com/node-pool": ${node_pool_label}
    storage:
      volumeClaimTemplate:
        spec:
          resources:
            requests:
              storage: ${alertmanager_persistence_size}

## =========================
## Blackbox Exporter (replicaCount from TF, image, resources)
## =========================
blackboxExporter:
  enabled: false
  replicaCount: ${blackbox_exporter_replica_count}
  image:
    registry: docker.io
    repository: bitnamilegacy/blackbox-exporter
  resources:
    requests:
      cpu: ${blackbox_exporter_request_cpu}
      memory: ${blackbox_exporter_request_memory}
    limits:
      cpu: ${blackbox_exporter_limit_cpu}
      memory: ${blackbox_exporter_limit_memory}
  nodeSelector:
    "doks.digitalocean.com/node-pool": ${node_pool_label}

## =========================
## Thanos Ruler (replicaCount from TF, image, storage resources)
## =========================
thanosRuler:
  replicaCount: ${thanos_ruler_replica_count}
  image:
    registry: docker.io
    repository: bitnamilegacy/thanos
  storage:
    requests:
      cpu: ${thanos_ruler_request_cpu}
      memory: ${thanos_ruler_request_memory}
    limits:
      cpu: ${thanos_ruler_limit_cpu}
      memory: ${thanos_ruler_limit_memory}
  nodeSelector:
    "doks.digitalocean.com/node-pool": ${node_pool_label}

## =========================
## Exporters (disabled for minimal footprint)
## =========================
exporters:
  node-exporter:
    enabled: false
  kube-state-metrics:
    enabled: false
